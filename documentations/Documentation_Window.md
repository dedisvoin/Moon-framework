# Документация модуля Window

## Обзор

Модуль `Window` является основным компонентом библиотеки PySGL для создания и управления графическими окнами. Он предоставляет полноценный интерфейс для работы с окнами, рендеринга графики и обработки событий.

**Версия:** 1.1.8  
**Автор:** Павлов Иван (Pavlov Ivan)  
**Лицензия:** MIT  
**Реализация:** 98%

## Основные возможности

- ✅ Полноценное управление окнами (создание, уничтожение, изменение размера)
- ✅ Комплексная система рендеринга с поддержкой View и мировых координат
- ✅ Управление производительностью (FPS, VSync, статистика)
- ✅ Обработка событий (клавиатура, мышь, джойстик, сенсорный ввод)
- ✅ Настройка прозрачности и визуальных эффектов

## Требования

- Python 3.8+
- Библиотека `keyboard` (для обработки клавиатуры)
- Библиотека `ctypes` (для работы с DLL)
- PySGL.dll (нативная библиотека рендеринга)

---

## Классы

### Window

Основной класс для создания и управления окном приложения.

#### Конструктор

```python
Window(width: int = 800, height: int = 600, 
       title: str = "PySGL Window", style: int = Style.Default, 
       vsync: bool = False, alpha: float = 255, 
       context_settings: ContextSettings | None = None)
```

**Параметры:**
- `width` - начальная ширина окна (по умолчанию 800)
- `height` - начальная высота окна (по умолчанию 600)
- `title` - заголовок окна
- `style` - стиль окна из перечисления `Window.Style`
- `vsync` - включение вертикальной синхронизации
- `alpha` - уровень прозрачности (0-255)
- `context_settings` - настройки OpenGL контекста

#### Стили окна (Window.Style)

```python
No = 0                        # Окно без декораций
Titlebar = 1 << 0             # Окно с заголовком
Resize = 1 << 1               # Изменяемый размер
Close = 1 << 2                # Кнопка закрытия
FullScreen = 1 << 3           # Полноэкранный режим
FullScreenDesktop = 1 << 4    # Псевдо-полноэкранный режим
Default = Titlebar | Resize | Close  # Стандартный набор
```

#### Основные методы

##### Управление окном

**Размер и позиция**

```python
def set_size(width: int, height: int) -> Self
```
**Описание:** Изменяет размер клиентской области окна. Минимальные и максимальные размеры зависят от системных ограничений. При изменении размера может быть сгенерировано событие `Resized`.

**Параметры:**
- `width` - новая ширина в пикселях (должна быть > 0)
- `height` - новая высота в пикселях (должна быть > 0)

**Возвращает:** `Self` для цепочки вызовов

**Исключения:** `ValueError` при недопустимых размерах

---

```python
def get_size() -> Vector2i
```
**Описание:** Возвращает текущий размер клиентской области окна в пикселях. Учитывает только рабочую область без рамок и заголовка. Размеры автоматически обновляются при изменении окна пользователем.

**Возвращает:** `Vector2i` с шириной (x) и высотой (y) окна

---

```python
def set_position(x: int, y: int) -> Self
```
**Описание:** Устанавливает позицию окна на экране относительно верхнего левого угла. Координаты указываются в пикселях экрана. Может быть ограничено системными настройками многомониторных конфигураций.

**Параметры:**
- `x` - горизонтальная позиция в пикселях
- `y` - вертикальная позиция в пикселях

**Возвращает:** `Self` для цепочки вызовов

---

```python
def get_position() -> Vector2i
```
**Описание:** Возвращает текущую позицию окна на экране. Координаты относительно верхнего левого угла основного монитора. Учитывает системные рамки окна.

**Возвращает:** `Vector2i` с координатами (x, y) верхнего левого угла окна

---

```python
def get_center() -> Vector2f
```
**Описание:** Вычисляет и возвращает координаты центра клиентской области окна. Полезно для центрирования элементов интерфейса или игровых объектов. Координаты в пикселях относительно левого верхнего угла окна.

**Возвращает:** `Vector2f` с координатами центра (x, y)

---

**Заголовок и внешний вид**

```python
def set_title(title: str) -> Self
```
**Описание:** Изменяет текст в заголовке окна. Поддерживает Unicode символы и влияет на отображение в панели задач. Заголовок также используется системой для идентификации окна.

**Параметры:**
- `title` - новый заголовок окна (строка UTF-8)

**Возвращает:** `Self` для цепочки вызовов

---

```python
def get_title() -> str
```
**Описание:** Возвращает текущий заголовок окна. Соответствует последнему значению, установленному через `set_title()` или переданному в конструктор.

**Возвращает:** Строка с текущим заголовком окна

---

```python
def set_alpha(alpha: int) -> None
```
**Описание:** Устанавливает глобальную прозрачность окна через WinAPI. Требует установки стиля `WS_EX_LAYERED`. Работает только на Windows - кроссплатформенные решения пока не реализованы.

**Параметры:**
- `alpha` - уровень прозрачности (0 = полностью прозрачное, 255 = непрозрачное)

**Примечание:** Может влиять на производительность рендеринга

---

```python
def get_alpha() -> float
```
**Описание:** Возвращает текущий уровень прозрачности окна в диапазоне 0-255. Соответствует последнему значению, установленному через `set_alpha()`.

**Возвращает:** Текущий уровень прозрачности (float)

---

```python
def enable_rounded_corners() -> Self  # Windows 11+
```
**Описание:** Применяет современный стиль с закругленными углами к окну. Использует DWM API Windows 11. На других ОС или версиях Windows эффекта не будет - метод выполнится без ошибок, но визуального изменения не произойдет.

**Возвращает:** `Self` для цепочки вызовов

**Требования:** Windows 11 или новее

---

**Состояние окна**

```python
def is_open() -> bool
```
**Описание:** Проверяет, создано ли окно и не было ли оно закрыто. Возвращает `False` если окно было закрыто через `close()` или пользователем. После закрытия окно нельзя использовать повторно.

**Возвращает:** `True` если окно открыто и готово к использованию, `False` если закрыто

---

```python
def close() -> None
```
**Описание:** Полностью закрывает окно и освобождает все связанные системные ресурсы. Завершает работу графического контекста OpenGL. После вызова окно становится непригодным для использования.

**Примечание:** Рекомендуется вызывать в конце работы приложения для корректного освобождения ресурсов

---

```python
def enable() -> None    # Windows only
```
**Описание:** Активирует окно и восстанавливает возможность взаимодействия с ним. Возвращает нормальный вид заголовка окна и разблокирует пользовательский ввод. Автоматически устанавливает внутренний флаг `__active` в `True`.

**Платформа:** Только Windows (использует WinAPI)

---

```python
def disable() -> None   # Windows only
```
**Описание:** Деактивирует окно и блокирует взаимодействие с ним. Затемняет заголовок окна как визуальный индикатор неактивности. Блокирует весь пользовательский ввод. Автоматически устанавливает внутренний флаг `__active` в `False`.

**Платформа:** Только Windows (использует WinAPI)

---

```python
def get_active() -> bool
```
**Описание:** Проверяет, является ли окно активным (не заблокированным программно). Возвращает `True` если окно не заблокировано через `disable()`, `False` если заблокировано. Не связано с системным фокусом окна.

**Возвращает:** `True` если окно активно, `False` если заблокировано программно

##### Рендеринг

**Основной цикл рендеринга**

```python
def clear(color: Color | None = None) -> None
```
**Описание:** Очищает буфер рисования окна указанным цветом. Должен вызываться перед началом рисования каждого кадра для предотвращения артефактов от предыдущих кадров. Если цвет не указан, используется цвет по умолчанию из `set_clear_color()`.

**Параметры:**
- `color` - цвет очистки (`Color`) или `None` для цвета по умолчанию

**Исключения:** `TypeError` при передаче недопустимого типа цвета

---

```python
def draw(shape, render_states: RenderStates | Shader | None = None) -> None
```
**Описание:** Основной метод отрисовки графических объектов. Поддерживает три режима: стандартный (без параметров), с пользовательскими состояниями рендеринга и с шейдерами. Автоматически определяет тип объекта и выбирает оптимальный способ отрисовки.

**Параметры:**
- `shape` - отрисовываемый объект (должен иметь метод `get_ptr()`)
- `render_states` - параметры рендеринга (`RenderStates`), шейдер (`Shader`) или `None`

**Поддерживаемые объекты:** Sprites, Shapes, Text, Lines и другие drawable объекты

**Примечание:** Специальные объекты (например, `LineThinShape`) обрабатываются в Python коде, стандартные передаются в нативную библиотеку

---

```python
def display() -> None
```
**Описание:** Отображает все нарисованные объекты на экране путем переключения буферов (double buffering). Должен вызываться после завершения рисования кадра. Все операции рисования между `clear()` и `display()` будут показаны одновременно.

**Примечание:** Время выполнения зависит от настроек VSync и производительности GPU

---

**Настройки рендеринга**

```python
def set_clear_color(color: Color) -> Self
```
**Описание:** Устанавливает цвет очистки по умолчанию, который будет использоваться при вызове `clear()` без параметров. Не влияет на уже нарисованное содержимое - применяется только при следующих вызовах `clear()`.

**Параметры:**
- `color` - цвет для очистки (объект `Color`)

**Возвращает:** `Self` для цепочки вызовов

---

```python
def get_clear_color() -> Color
```
**Описание:** Возвращает текущий цвет очистки по умолчанию. Показывает цвет, установленный через `set_clear_color()` или заданный при инициализации окна.

**Возвращает:** Объект `Color` с текущим цветом очистки

---

```python
def set_vertical_sync(value: bool) -> Self
```
**Описание:** Управляет вертикальной синхронизацией (VSync). При включении синхронизирует частоту кадров с частотой обновления монитора, устраняя артефакты разрыва изображения. Может снизить нагрузку на GPU, но ограничивает максимальный FPS.

**Параметры:**
- `value` - `True` для включения VSync, `False` для выключения

**Возвращает:** `Self` для цепочки вызовов

**Примечание:** Изменения применяются немедленно

---

```python
def enable_vsync() -> Self
```
**Описание:** Быстрый способ включения вертикальной синхронизации. Эквивалентен `set_vertical_sync(True)`. Полезен для цепочки вызовов при инициализации окна.

**Возвращает:** `Self` для цепочки вызовов

---

**Камера и координаты**

```python
def set_view(view: View) -> Self
```
**Описание:** Устанавливает активную камеру/область просмотра для всех последующих операций отрисовки. Определяет систему координат, масштабирование и поворот для графических объектов. По умолчанию используется стандартный View, охватывающий все окно.

**Параметры:**
- `view` - объект камеры/вида (`View`)

**Возвращает:** `Self` для цепочки вызовов

**Примечание:** Влияет на все операции рисования до установки нового View

---

```python
def get_default_view() -> View
```
**Описание:** Возвращает стандартное представление окна без трансформаций. Начало координат (0,0) в левом верхнем углу, масштаб 1:1, без поворота. Автоматически обновляется при изменении размера окна.

**Возвращает:** Объект `View` со стандартными настройками

**Использование:** Полезно для сброса камеры или отрисовки UI элементов

---

```python
def convert_window_coords_to_view_coords(x: float, y: float, view: View) -> Vector2f
```
**Описание:** Преобразует экранные координаты (пиксели окна) в мировые координаты относительно указанной камеры. Учитывает положение, масштаб и поворот камеры. Незаменимо для обработки пользовательского ввода (мышь, тач) в игровом пространстве.

**Параметры:**
- `x` - горизонтальная позиция в пикселях (от левого края окна)
- `y` - вертикальная позиция в пикселях (от верхнего края окна)
- `view` - камера для преобразования координат

**Возвращает:** `Vector2f` с преобразованными координатами в игровом пространстве

---

```python
def convert_view_coords_to_window_coords(x: float, y: float, view: View) -> Vector2f
```
**Описание:** Преобразует мировые координаты игрового пространства в экранные пиксели относительно указанной камеры. Обратная операция к `convert_window_coords_to_view_coords()`. Полезно для позиционирования UI элементов в мировых координатах.

**Параметры:**
- `x` - горизонтальная позиция в игровом пространстве
- `y` - вертикальная позиция в игровом пространстве
- `view` - камера для преобразования координат

**Возвращает:** `Vector2f` с экранными координатами в пикселях

##### Производительность

**FPS и тайминги**

```python
def set_wait_fps(fps: int) -> Self
```
**Описание:** Устанавливает ограничение максимальной частоты кадров. Реальное значение может быть ниже из-за ограничений системы, сложности сцены или нагрузки на GPU/CPU. Используйте `FPS_UNLIMIT_CONST` для снятия ограничений (осторожно - может привести к перегреву).

**Параметры:**
- `fps` - максимальные кадры в секунду (целое число или `FPS_UNLIMIT_CONST`)

**Возвращает:** `Self` для цепочки вызовов

**Предупреждение:** Снятие ограничения FPS может привести к перегреву устройства

---

```python
def get_wait_fps() -> int
```
**Описание:** Возвращает текущее ограничение FPS, установленное через `set_wait_fps()`. Значение `FPS_UNLIMIT_CONST` означает отсутствие ограничений.

**Возвращает:** Текущее ограничение FPS (целое число)

---

```python
def set_target_fps(fps: int) -> Self
```
**Описание:** Устанавливает эталонную частоту кадров для расчета delta-time. Не ограничивает фактический FPS рендеринга - используется только для нормализации игрового времени. Влияет на результат `get_delta()`.

**Параметры:**
- `fps` - целевые кадры в секунду для расчетов (должно быть > 0)

**Возвращает:** `Self` для цепочки вызовов

**Использование:** Обычно устанавливается равным желаемому FPS игры (например, 60)

---

```python
def get_target_fps() -> int
```
**Описание:** Возвращает эталонную частоту кадров, используемую для расчета delta-time. По умолчанию обычно 60 FPS.

**Возвращает:** Текущее целевое значение FPS

---

```python
def get_fps() -> float
```
**Описание:** Возвращает текущую частоту кадров, рассчитанную как среднее за последние несколько кадров. Учитывает только время рендеринга, не включая время логики приложения. Может колебаться в зависимости от нагрузки системы.

**Возвращает:** Текущее значение FPS (дробное число)

**Примечание:** Для стабильных измерений используйте усреднение за несколько кадров

---

```python
def get_render_time(factor: float = 1) -> float
```
**Описание:** Возвращает время, затраченное на рендеринг последнего кадра. Измеряет только время отрисовки, не включая время логики приложения и ожидания VSync. Полезно для профилирования и оптимизации производительности.

**Параметры:**
- `factor` - множитель для преобразования единиц (1 = секунды, 1000 = миллисекунды)

**Возвращает:** Время рендеринга в указанных единицах (float)

---

```python
def get_delta() -> float
```
**Описание:** Возвращает коэффициент delta-time - отношение реального FPS к целевому. Значение 1.0 означает идеальное соответствие, <1.0 - рендеринг медленнее целевого, >1.0 - быстрее. Используется для нормализации игрового времени независимо от FPS.

**Возвращает:** Коэффициент delta-time (float)

**Применение:** Умножайте скорости движения на delta для постоянной скорости при разном FPS

---

```python
def get_global_timer(factor: float = 1.0) -> float
```
**Описание:** Возвращает время работы приложения с момента создания окна. Отсчет начинается при инициализации и не зависит от пауз или остановок рендеринга. Полезно для анимаций, таймеров и измерения общего времени работы.

**Параметры:**
- `factor` - множитель времени (1.0 = реальное время, 2.0 = ускоренное в 2 раза)

**Возвращает:** Время работы в секундах × factor

---

**Отладочная информация**

```python
def set_view_info(value: bool = True) -> Self
```
**Описание:** Включает или выключает отображение панели отладочной информации в верхнем левом углу окна. Показывает FPS, время рендеринга, delta-time, состояние VSync и график производительности. Полезно для отладки и оптимизации.

**Параметры:**
- `value` - `True` для показа информации, `False` для скрытия

**Возвращает:** `Self` для цепочки вызовов

**Примечание:** Отображение информации требует вызова `view_info()` в цикле рендеринга

---

```python
def view_info() -> None
```
**Описание:** Отрисовывает панель отладочной информации о производительности. Включает текущий FPS, максимальный и минимальный FPS, время рендеринга, delta-time, состояние VSync и график изменения FPS. Адаптивная прозрачность при наведении курсора.

**Особенности:**
- Динамический график FPS с цветовой индикацией (зеленый/красный)
- Подсветка при наведении курсора в область информации
- Автоматическое использование стандартного View для корректного отображения

**Требования:** Должен быть включен флаг через `set_view_info(True)`

---

```python
def set_max_fps_history(number: int) -> Self
```
**Описание:** Устанавливает глубину истории значений FPS для построения графика производительности. Большие значения требуют больше памяти, но дают более точную и детальную статистику. Влияет на график в `view_info()`.

**Параметры:**
- `number` - максимальное количество сохраняемых значений FPS (должно быть > 0)

**Возвращает:** `Self` для цепочки вызовов

**Исключения:** `ValueError` при неположительном числе

**Рекомендация:** 60-120 значений для 1-2 секунд истории при 60 FPS

---

```python
def get_max_fps_history() -> int
```
**Описание:** Возвращает текущий размер истории FPS, установленный через `set_max_fps_history()`. Показывает, сколько последних значений FPS сохраняется в памяти для анализа.

**Возвращает:** Текущая глубина истории значений FPS

##### Курсор и ввод

**Видимость курсора**

```python
def hide_cursor() -> Self
```
**Описание:** Скрывает системный курсор при наведении на область окна. Курсор остается функциональным, но становится невидимым. Состояние сохраняется для последующего восстановления через `show_cursor()`. Полезно для полноэкранных игр или кастомных курсоров.

**Возвращает:** `Self` для цепочки вызовов

**Примечание:** Курсор остается скрытым только в пределах окна

---

```python
def show_cursor() -> Self
```
**Описание:** Восстанавливает видимость системного курсора в области окна. Возвращает стандартное поведение курсора. Отменяет эффект `hide_cursor()`.

**Возвращает:** `Self` для цепочки вызовов

---

```python
def get_cursor_visibility() -> bool
```
**Описание:** Проверяет текущее состояние видимости курсора в окне. Возвращает значение, соответствующее последнему вызову `show_cursor()` или `hide_cursor()`.

**Возвращает:** `True` если курсор видим, `False` если скрыт

---

**Системные курсоры**

```python
def set_system_cursor(cursor: SystemCursors) -> Self
```
**Описание:** Устанавливает тип системного курсора для окна из предопределенного набора. Позволяет использовать стандартные курсоры операционной системы (стрелка, рука, текстовый, изменение размера и др.). Курсор изменяется только при наведении на окно.

**Параметры:**
- `cursor` - тип курсора из перечисления `SystemCursors`

**Возвращает:** `Self` для цепочки вызовов

**Доступные курсоры:** Arrow, Hand, Text, Wait, SizeHorizontal, Cross и другие

---

```python
def get_cursor() -> SystemCursors
```
**Описание:** Возвращает текущий установленный системный курсор окна. Соответствует последнему значению, переданному в `set_system_cursor()`.

**Возвращает:** Текущий тип курсора из перечисления `SystemCursors`

---

**Обработка событий**

```python
def update(events: WindowEvents) -> bool
```
**Описание:** Основной метод обновления состояния окна, который должен вызываться каждый кадр в главном цикле приложения. Выполняет множество критически важных операций: обрабатывает события окна, вычисляет метрики производительности, управляет эффектами и проверяет условия закрытия.

**Параметры:**
- `events` - объект `WindowEvents` для работы с событиями

**Возвращает:** `True` если окно должно продолжать работу, `False` если требуется закрытие

**Выполняемые операции:**
1. Обновление эффекта "призрачности" (если включен)
2. Расчет FPS, render_time и delta-time
3. Обновление истории FPS для графика
4. Обработка событий из системной очереди
5. Проверка условий закрытия (события Closed, клавиша выхода)
6. Обработка изменения размера окна
7. Обновление флагов состояния

**Критически важно:** Должен вызываться каждый кадр для корректной работы окна

---

```python
def get_resized() -> bool
```
**Описание:** Проверяет, произошло ли изменение размера окна в текущем кадре. Флаг автоматически сбрасывается при следующем вызове `update()`. Полезно для адаптации интерфейса, пересчета позиций элементов или обновления проекционных матриц.

**Возвращает:** `True` если размер изменился в этом кадре, `False` в противном случае

**Примечание:** Флаг устанавливается только при фактическом изменении размера, не при каждом событии

---

```python
def set_exit_key(key: str) -> Self
```
**Описание:** Устанавливает клавишу или комбинацию клавиш для автоматического закрытия окна. Использует глобальное отслеживание клавиатуры через библиотеку `keyboard`. По умолчанию установлена клавиша "esc".

**Параметры:**
- `key` - идентификатор клавиши в формате библиотеки keyboard ("esc", "space", "ctrl+c", "alt+f4")

**Возвращает:** `Self` для цепочки вызовов

**Примеры:** "esc", "q", "ctrl+q", "alt+f4", "space"

---

```python
def get_exit_key() -> str
```
**Описание:** Возвращает текущую клавишу для закрытия окна, установленную через `set_exit_key()` или заданную по умолчанию.

**Возвращает:** Строка с идентификатором клавиши или комбинации

##### Специальные эффекты

**Эффект "призрачного" окна**

```python
def enable_ghosting(value: bool = True) -> Self
```
**Описание:** Включает или выключает эффект "призрачности" окна - автоматическое изменение прозрачности в зависимости от положения курсора мыши. При включении окно становится полупрозрачным когда курсор находится вне его области, и возвращается к нормальной прозрачности при наведении.

**Параметры:**
- `value` - `True` для включения эффекта, `False` для выключения

**Возвращает:** `Self` для цепочки вызовов

**Механизм работы:**
- Курсор в окне: прозрачность = 255 (непрозрачное)
- Курсор вне окна: прозрачность = значение из `set_ghosting_min_alpha()`
- Плавная интерполяция между состояниями

**Примечание:** Эффект обрабатывается в методе `update()` каждый кадр

---

```python
def get_ghosting() -> bool
```
**Описание:** Проверяет, включен ли эффект "призрачности" окна. Возвращает состояние, установленное последним вызовом `enable_ghosting()`.

**Возвращ��ет:** `True` если эффект включен, `False` если выключен

---

```python
def set_ghosting_min_alpha(alpha: int) -> Self
```
**Описание:** Устанавливает минимальный уровень прозрачности для эффекта "призрачности". Это значение используется когда курсор мыши находится вне области окна. Чем меньше значение, тем более прозрачным становится окно.

**Параметры:**
- `alpha` - минимальная прозрачность (0-255, где 0 = полностью прозрачное, 255 = непрозрачное)

**Возвращает:** `Self` для цепочки вызовов

**Действие:** Применяется только при включенном эффекте ghosting

**Рекомендуемые значения:** 30-100 для заметного, но не чрезмерного эффекта

---

```python
def get_ghosting_min_alpha() -> int
```
**Описание:** Возвращает текущее минимальное значение прозрачности для эффекта "призрачности", установленное через `set_ghosting_min_alpha()`.

**Возвращает:** Текущее минимальное значение прозрачности (0-255)

---

### WindowEvents

Класс для обработки событий окна.

#### Типы событий (WindowEvents.Type)

```python
Closed = 0                     # Окно закрыто
Resized = 1                    # Изменен размер
LostFocus = 2                  # Потеря фокуса
GainedFocus = 3                # Получение фокуса
TextEntered = 4                # Ввод текста

KeyPressed = 5                 # Нажата клавиша
KeyReleased = 6                # Отпущена клавиша

MouseWheelMoved = 7            # Прокрутка колеса (устаревший)
MouseWheelScrolled = 8         # Прокрутка колеса
MouseButtonPressed = 9         # Нажата кнопка мыши
MouseButtonReleased = 10       # Отпущена кнопка мыши
MouseMoved = 11                # Движение мыши
MouseEntered = 12              # Курсор вошел в окно
MouseLeft = 13                 # Курсор покинул окно

JoystickButtonPressed = 14     # Нажата кнопка джойстика
JoystickButtonReleased = 15    # Отпущена кнопка джойстика
JoystickMoved = 16             # Движение оси джойстика
JoystickConnected = 17         # Джойстик подключен
JoystickDisconnected = 18      # Джойстик отключен

TouchBegan = 19                # Начало касания
TouchMoved = 20                # Движение касания
TouchEnded = 21                # Окончание касания
SensorChanged = 22             # Изменение датчика
```

#### Методы

```python
def __init__()
```
**Описание:** Инициализирует обработчик событий окна. Создает нативный объект для хранения событий и подготавливает внутренние структуры данных для работы с системной очередью сообщений.

**Исключения:** `RuntimeError` при ошибке создания нативного объекта

---

```python
def poll(window) -> bool
```
**Описание:** Проверяет наличие событий в системной очереди сообщений для указанного окна. Извлекает следующее событие из очереди и подготавливает его для обработки. Должен вызываться в цикле для обработки всех накопившихся событий.

**Параметры:**
- `window` - объект окна для проверки событий

**Возвращает:** `True` если есть непрочитанное событие, `False` если очередь пуста

**Использование:** Обычно вызывается в цикле `while events.poll(window):`

---

```python
def get_type() -> int
```
**Описание:** Возвращает тип текущего события из перечисления `WindowEvents.Type`. Должен вызываться после успешного `poll()` для определения типа полученного события.

**Возвращает:** Код события (целое число) из `WindowEvents.Type`

**Примеры значений:** `WindowEvents.Type.KeyPressed`, `WindowEvents.Type.MouseMoved`

---

```python
def get_key() -> int
```
**Описание:** Возвращает код нажатой или отпущенной клавиши для событий клавиатуры. Применимо только для событий `KeyPressed` и `KeyReleased`. Коды клавиш соответствуют стандартному перечислению KeyCode.

**Возвращает:** Код клавиши (целое число)

**Применимость:** Только для событий типа `KeyPressed` и `KeyReleased`

---

```python
def get_mouse_button() -> int
```
**Описание:** Возвращает код кнопки мыши для событий нажатия/отпускания кнопок мыши. Стандартные значения: 0 - левая кнопка, 1 - правая кнопка, 2 - средняя кнопка (колесо).

**Возвращает:** Код кнопки мыши (0, 1, 2 или больше для дополнительных кнопок)

**Применимость:** Только для событий `MouseButtonPressed` и `MouseButtonReleased`

---

```python
def get_mouse_wheel() -> int
```
**Описание:** Возвращает значение прокрутки колеса мыши. Положительные значения означают прокрутку вверх (от пользователя), отрицательные - вниз (к пользователю). Величина значения может указывать на интенсивность прокрутки.

**Возвращает:** Шаги прокрутки (>0 - вверх, <0 - вниз, 0 - нет прокрутки)

**Применимость:** Для событий `MouseWheelMoved` и `MouseWheelScrolled`

---

```python
def get_mouse_x() -> int
```
**Описание:** Возвращает X-координату курсора мыши в пикселях относительно левого края клиентской области окна. Координата 0 соответствует левому краю окна.

**Возвращает:** Горизонтальная координата в пикселях (целое число)

**Применимость:** Для всех событий мыши, связанных с позицией

---

```python
def get_mouse_y() -> int
```
**Описание:** Возвращает Y-координату курсора мыши в пикселях относительно верхнего края клиентской области окна. Координата 0 соответствует верхнему краю окна.

**Возвращает:** Вертикальная координата в пикселях (целое число)

**Применимость:** Для всех событий мыши, связанных с позицией

---

```python
def get_size_width() -> int
```
**Описание:** Возвращает новую ширину окна после изменения размера. Значение соответствует ширине клиентской области в пикселях, без учета рамок и заголовка окна.

**Возвращает:** Новая ширина окна в пикселях

**Применимость:** Только для события `Resized`

---

```python
def get_size_height() -> int
```
**Описание:** Возвращает новую высоту окна после изменения размера. Значение соответствует высоте клиентской области в пикселях, без учета рамок и заголовка окна.

**Возвращает:** Новая высота окна в пикселях

**Применимость:** Только для события `Resized`

---

### ContextSettings

Класс для настройки параметров графического контекста OpenGL.

#### Методы

```python
def __init__()
```
**Описание:** Инициализирует объект настроек графического контекста OpenGL с параметрами по умолчанию. Создает нативный объект для хранения настроек, который будет передан при создании окна.

**Параметры по умолчанию:**
- Антиалиасинг: выключен
- Буфер глубины: стандартный
- Буфер трафарета: стандартный
- Версия OpenGL: системная по умолчанию
- sRGB: выключен

---

```python
def set_antialiasing_level(level: int) -> Self
```
**Описание:** Устанавливает уровень сглаживания (антиалиасинга) для устранения зубчатых краев графических объектов. Более высокие значения дают лучшее качество, но снижают производительность. Поддерживаемые уровни зависят от видеокарты.

**Параметры:**
- `level` - уровень сглаживания (0 = выключен, 2, 4, 8, 16 - типичные значения)

**Возвращает:** `Self` для цепочки вызовов

**Примечание:** Не все видеокарты поддерживают все уровни антиалиасинга

---

```python
def set_depth_bits(bits: int) -> Self
```
**Описание:** Устанавливает количество бит для буфера глубины (Z-buffer), используемого для корректного отображения перекрывающихся объектов в 3D пространстве. Больше бит = выше точность, но больше памяти.

**Параметры:**
- `bits` - количество бит для буфера глубины (обычно 16, 24 или 32)

**Возвращает:** `Self` для цепочки вызовов

**Рекомендация:** 24 бита для большинства приложений, 32 для высокой точности

---

```python
def set_stencil_bits(bits: int) -> Self
```
**Описание:** Устанавливает количество бит для буфера трафарета (stencil buffer), используемого для сложных операций маскирования и отсечения при рендеринге. Требуется для некоторых продвинутых графических эффектов.

**Параметры:**
- `bits` - количество бит для буфера трафарета (обычно 8)

**Возвращает:** `Self` для цепочки вызовов

**Использование:** Необходим для теней, отражений, сложного отсечения

---

```python
def set_opengl_version(major: int, minor: int) -> Self
```
**Описание:** Запрашивает конкретную версию OpenGL для графического контекста. Позволяет использовать функции определенной версии API. Если запрошенная версия недоступна, будет создан контекст с максимально доступной версией.

**Параметры:**
- `major` - основная версия OpenGL (например, 3 для OpenGL 3.3)
- `minor` - дополнительная версия (например, 3 для OpenGL 3.3)

**Возвращает:** `Self` для цепочки вызовов

**Популярные версии:** 3.3 (совместимость), 4.1 (macOS), 4.6 (современные возможности)

---

```python
def set_srgb_capable(capable: bool) -> Self
```
**Описание:** Включает поддержку sRGB цветового пространства для корректного отображения цветов. sRGB обеспечивает более точную цветопередачу, особенно важную для текстур и изображений.

**Параметры:**
- `capable` - `True` для включения поддержки sRGB, `False` для стандартного RGB

**Возвращает:** `Self` для цепочки вызовов

**Рекомендация:** Включать для современных приложений с точной цветопередачей

---

```python
def set_attribute_flags(flags: int) -> Self
```
**Описание:** Устанавливает дополнительные флаги атрибутов контекста OpenGL. Позволяет настроить специфические параметры контекста через битовую маску флагов.

**Параметры:**
- `flags` - битовая маска флагов контекста (зависит от реализации)

**Возвращает:** `Self` для цепочки вызовов

**Примечание:** Для продвинутого использования, требует знания OpenGL API

---

### SystemCursors

Перечисление системных курсоров.

```python
Arrow = 0                     # Стандартная стрелка
ArrowWait = 1                 # Стрелка с ожиданием
Wait = 2                      # Ожидание
Text = 3                      # Текстовый курсор
Hand = 4                      # Рука

# Курсоры изменения размера
SizeHorizontal = 5            # Горизонтальное изменение
SizeVertical = 6              # Вертикальное изменение
SizeTopLeftBottomRight = 7    # Диагональное ↖↘
SizeBottomLeftTopRight = 8    # Диагональное ↙↗

# Направленные курсоры
SizeLeft = 9                  # Влево
SizeRight = 10                # Вправо
SizeTop = 11                  # Вверх
SizeBottom = 12               # Вниз

# Угловые курсоры
SizeTopLeft = 13              # Верхний левый
SizeBottomRight = 14          # Нижний правый
SizeBottomLeft = 15           # Нижний левый
SizeTopRight = 16             # Верхний правый

SizeAll = 17                  # Перемещение
Cross = 18                    # Перекрестие
Help = 19                     # Справка
NotAllowed = 20               # Запрещено
```

---

## Константы

```python
FPS_UNLIMIT_CONST = 1000000   # Неограниченный FPS
```

---

## Функции

```python
def get_screen_resolution() -> TwoIntegerList
```
Возвращает разрешение основного монитора.

---

## Примеры использования

### Базовое окно

```python
from PySGL import Window, WindowEvents, Color

# Создание окна
window = Window(800, 600, "Мое приложение")
events = WindowEvents()

# Основной цикл
while window.is_open():
    # Обработка событий
    if not window.update(events):
        break
    
    # Рендеринг
    window.clear(Color(50, 50, 50))
    # ... отрисовка объектов ...
    window.display()

window.close()
```

### Полноэкранное окно с настройками

```python
from PySGL import Window, ContextSettings

# Настройки OpenGL
settings = ContextSettings()
settings.set_antialiasing_level(4)
settings.set_opengl_version(3, 3)

# Полноэкранное окно
window = Window(
    style=Window.Style.FullScreen,
    vsync=True,
    context_settings=settings
)
```

### Отладка производительности

```python
# Включить отображение FPS
window.set_view_info(True)
window.set_max_fps_history(120)  # 2 секунды истории при 60 FPS

# Ограничить FPS
window.set_wait_fps(60)

# В цикле рендеринга
print(f"FPS: {window.get_fps():.1f}")
print(f"Время рендера: {window.get_render_time(1000):.1f}ms")
```

### Обработка событий

```python
while events.poll(window):
    event_type = events.get_type()
    
    if event_type == WindowEvents.Type.KeyPressed:
        key = events.get_key()
        print(f"Нажата клавиша: {key}")
    
    elif event_type == WindowEvents.Type.MouseButtonPressed:
        button = events.get_mouse_button()
        x, y = events.get_mouse_x(), events.get_mouse_y()
        print(f"Клик кнопкой {button} в ({x}, {y})")
    
    elif event_type == WindowEvents.Type.Resized:
        width = events.get_size_width()
        height = events.get_size_height()
        print(f"Новый размер: {width}x{height}")
```

### Эффекты окна

```python
# Прозрачность
window.set_alpha(200)  # Полупрозрачное окно

# Эффект "призрачности"
window.enable_ghosting()
window.set_ghosting_min_alpha(50)

# Скругленные углы (Windows 11+)
window.enable_rounded_corners()

# Скрыть курсор
window.hide_cursor()

# Установить курсор-руку
window.set_system_cursor(SystemCursors.Hand)
```

---

## Особенности платформы

### Windows
- Поддержка прозрачности окна через WinAPI
- Скругленные углы в Windows 11+
- Эффект "призрачности" окна
- Блокировка/разблокировка окна

### Кроссплатформенность
- Основная функциональность работает на всех платформах
- Некоторые эффекты (прозрачность, скругленные углы) специфичны для Windows
- Планируется расширение поддержки других ОС

---

## Рекомендации по использованию

### Производительность
- Используйте VSync для устранения разрывов изображения
- Ограничивайте FPS для экономии ресурсов
- Мониторьте время рендеринга через `get_render_time()`

### Обработка событий
- Всегда вызывайте `update()` в основном цикле
- Обрабатывайте события изменения размера окна
- Используйте `get_resized()` для адаптации интерфейса

### Рендеринг
- Вызывайте `clear()` перед отрисовкой каждого кадра
- Используйте `display()` после завершения отрисовки
- Настраивайте View для управления камерой

### Отладка
- Включайте `view_info()` для мониторинга производительности
- Используйте историю FPS для анализа стабильности
- Настраивайте размер истории в зависимости от потребностей

---

## Лицензия

MIT License - Copyright (c) 2025 Pavlov Ivan

Разрешается свободное использование, копирование, изменение и распространение при условии сохранения уведомления об авторских правах.